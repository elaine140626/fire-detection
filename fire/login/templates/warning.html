{% extends 'base.html' %}
{% load staticfiles %}

{% block title%}告警分析{% endblock %}

{% block main_body %}
<div class="warning-body center">
        <div class="warning-content">
            <div class="tbl-header">
                <table cellpadding="0" cellspacing="0" border="0">
                    <thead>
                    <tr>
                        <th>编号</th>
                        <th>日期</th>
                        <th>预警详情</th>
                        <th>设备编号</th>
                        <th>设备标识</th>
                        <th>审核状态</th>
                        <th>告警图片</th>
                    </tr>
                    </thead>
                </table>
            </div>
            <div class="tbl-content" id="warning-table">
                <table cellpadding="0" cellspacing="0" border="0">
                    <tbody id="add-tr">
                    </tbody>
                </table>
            </div>
        </div>
        <div class="warning-bar">

        </div>
</div>
{% endblock %}

{% block script %}
    <script src=" {% static 'js/warning.js' %}"></script>
    <script>
        var UserMessageList = {{ user_message_list|safe }};

        var addTr = document.getElementById('add-tr');

        function appendChildren(father,children) {
            console.log(children);
            for(i in children){
                father.appendChild(i);
            }
        }

        for(let i=0; i < UserMessageList.length; i++){
            let theNumber = document.createElement('td'),
                theDate = document.createElement('td'),
                theInfo = document.createElement('td'),
                DeviceNumber = document.createElement('td'),
                DeviceHint = document.createElement('td'),
                theStatus = document.createElement('td'),
                thePic = document.createElement('td'),
                realPic = document.createElement('img');

            let theTd = document.createElement('tr');

            let Node = UserMessageList[i];
            console.log(Node);
            console.log(Node['id']);
            theNumber.innerText = Node['id'];
            console.log(theNumber.innerText);
            console.log(theNumber);
            theDate.innerText = Node['c_time'];
            theInfo.innerText = Node['content'];
            DeviceNumber.innerText = Node['device_number'];
            DeviceHint.innerText = Node['device_hint'];
            theStatus.innerText  = (Node['deal'] ? '已审核':'未审核');
            realPic.src = Node['img_url'];
            thePic.appendChild(realPic);
            let list = [theNumber,theDate,theInfo,DeviceNumber,DeviceHint,theStatus,thePic];

            theTd.appendChild(theNumber);
            theTd.appendChild(theDate);
            theTd.appendChild(theInfo);
            theTd.appendChild(DeviceNumber);
            theTd.appendChild(DeviceHint);
            theTd.appendChild(theStatus);
            theTd.appendChild(thePic);

            addTr.appendChild(theTd);

        }
    </script>
{% endblock %}